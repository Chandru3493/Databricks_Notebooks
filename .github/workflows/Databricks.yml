name: Databricks Deployment

on:
  push:
    branches:
      - Dev
      - main

jobs:
  deploy-Dev:
    if: github.ref == 'refs/heads/Dev'
    runs-on: self-hosted

    steps:
      - name: Check if Databricks CLI is installed
        id: check-databricks-cli
        run: |
          if ! command -v databricks &> /dev/null
          then
            echo "Databricks CLI not found, installing..."
            Set-ExecutionPolicy Bypass -Scope Process -Force; [System.Net.ServicePointManager]::SecurityProtocol = [System.Net.ServicePointManager]::SecurityProtocol -bor 3072; iex ((New-Object System.Net.WebClient).DownloadString('https://community.chocolatey.org/install.ps1'))
            Databricks --version
          else
            echo "Databricks CLI is already installed."
          fi

  # deploy-prod:
  #   if: github.ref == 'refs/heads/main'
  #   runs-on: ubuntu-latest

  #   steps:
  #     - name: Checkout code
  #       uses: actions/checkout@v3

  #     - name: Install Databricks CLI
  #       run: |
  #         echo "Hello World"
